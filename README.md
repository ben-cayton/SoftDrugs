# SoftDrugs
## The SoftDrugs team AI drug repositioning

The goal of this project was to reproduce the results of “An Automated Framework for QSAR Model Building” to show a proof-of-concept of their workflow within the context of DeepChem’s “Tutorial 13: Modeling Protein-Ligand Interactions”.1,2 We constructed a machine learning (ML) model based on the workflow of Kauser et al. We gathered and prepared our data based on guidance from the DeepChem tutorial. We performed verification and validation of our ML model construction using three datasets. The verification benchmark value was a MODI score > 0.45, and the validation benchmark value was an R2 > 0.6. The best MODI we achieved was 0.61 using the BACE1 dataset. The best R2 from the validation test was 0.74, also using the BACE1 dataset. We did not meet either performance benchmark on a dataset containing multiple receptor proteins but in completing all the purposed steps we show a proof-of-concept of the workflow. The chief limitation which prevented us from achieving benchmark performance values on multi-receptor datasets was the lack of a protein-ligand complex featurizer. Our results show an improvement over the DeepChem tutorial using a dataset with multiple receptor proteins. We did meet all benchmark values using the BACE1 dataset which suggests it is possible to predict the bioactivity of a protein-ligand interaction without a protein-ligand complex featurizer, however the features must adequately describe the bioactivity. We recommend that a functioning, open-source protein-ligand complex featurizer is released for future researchers.  

### Background and Introduction background 

Drug discovery is an expensive endeavor which can cost billions of dollars and take decades of research to complete for a single drug. Traditional laboratory methods in pre-clinical drug trials have a high dropout rate which leads to high sunken costs in drug development. Methods need to be developed to decrease the dropout rate of new drugs. One method is to use in silico modeling. In silico methods have the potential to supplement or replace pre-clinical drug trials which reduce the dropout rate of new drugs. In silico methods are a new field within drug research and thus require further development. The purpose of this project was to perform a reproducibility study of an in silico method pertaining to drug research.  

### Design Requirements 

There were three requirements for our proposed design. We had to featurize the databases containing information of small drug-like proteins. The data which was outputted by the featurizer had to be run in a machine learning algorithm for binding predictions. Last, we had to use statistical analysis to calculate the accuracy and modelability of the algorithm. 

### Design Details 

The databases used were PDBbind, BACE, and CATS datasets all of which have molecules listed in either mol2 or SMILES format. We used python 3.6 and packages required for preprocessing and learning which were, DeepChem, SKLearn, RDKit, Numpy, and Pubchempy. The preprocessing routine transferred chemical structure data into a mol2 format, split the data into training, validation, and test sets, and featurized the data using each of the four featurizers. The data was then put through our verification and validation testing to test modelability, feature importance ranking and feature elimination. The final learning model used the selected features from the verification test and used Epsilon-Support Vector Regression from SKLearn to test the validation set.  

### Verification and Validation 

We performed three phases of verification. The phases were modelability, feature importance, and minimum feature analysis. The modelability analysis phase was done by running featurized data into a Leave-One-Out cross validation (LOOCV) of a k-Nearest Neighbors (kNN) model. From this analysis we got a score for modelability known as MODI. The second of the phases was the feature importance analysis which ranked the features by importing the features into a random forest model to obtain a score known as “mean decrease in impurity”. The last verification phase was the minimum number of features analysis which was performed by using a support vector machine (SVM) and increasing the number of features used for the SVM and selecting the highest R2 score and the lowest mean squared error (MSE). The validation test used data split from the training data to determine how well the test data compares to known values and returns an R2 and MSE as well as compute time. 

### Results 

The featurizers used were The Circular Fingerprint, RDkit Descriptors, and MACCSKeys. Each of the featurizers were trained on a different split. The PDBbind dataset split was 5771:1242:1247. The split for the BACE dataset was 1059:227:227. The split for the CATS dataset was 321:69:69. The modelability test showed Pubchem and circular fingerprint featurizers having the highest MODI score. The feature importance analysis ranked the features by importance score with the highest being 0.16. The feature elimination step was performed to reduce noise and reduce over fitting. The best MODI we achieved was 0.61 using the BACE1 dataset. The best R2 from the validation test was 0.74, also using the BACE1 dataset. 

### Recommendation and Limitations 

Our program had many limitations during this project which required creative thinking and the redesign of several key elements. Primarily, the largest limitations experienced was the misfunction of the primary set of featurizers we used, limits on computational resources, as well as some issues with the validity and statistical analysis of our model. As such, there are many recommendations we can provide for either anyone planning to continue this project, or if we pursue the project further. Principally, we would recommend that any further progress in this project should employ a function capable of simulating docking mechanics of protein-ligand complexes which would remove dependencies on external libraries and functions. 
